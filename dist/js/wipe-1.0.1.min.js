/*!BuildUpFromNothing-wipe 1.0.1 发布日期:2018-11-13*/
var movex,movey,cas=document.getElementById("cas"),context=cas.getContext("2d"),_w=cas.width,_h=cas.height,raduis=10,isMouseDown=!1,t=0,device=/android|webos|iPhone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase()),Press=device?"touchstart":"mousedown",Move=device?"touchmove":"mousemove",Uplift=device?"touchend":"mouseup";function drawMask(e){e.fillStyle="#666",e.fillRect(0,0,375,667),e.globalCompositeOperation="destination-out"}function drawRound(e,t,o,n,i){e.save(),e.beginPath(),3==arguments.length?(e.arc(t,n,raduis,0,2*Math.PI),e.fillStyle="red",e.fill()):(e.lineCap="round",e.lineWidth=2*raduis,e.moveTo(t,o),e.lineTo(n,i),e.stroke()),e.restore()}function clearRect(e){e.clearRect(0,0,_w,_h)}function getTransparencyPercent(e){for(var o=e.getImageData(0,0,_w,_h),n=0;n<o.data.length;n+=4){0==o.data[n+3]&&t++}console.log("透明点的个数:"+t);var i=t/(_w*_h)*100;return console.log("占总面积"+Math.ceil(i)+"%"),Math.round(i)}function down(e){var t=e||window.event;movex=device?t.touches[0].clientX:t.clientX,movey=device?t.touches[0].clientY:t.clientY,drawRound(context,movex,movey),drawRound(context,movex,movey),isMouseDown=!0}function move(e){if(!isMouseDown)return!1;var t=e||window.event;t.preventDefault();var o=device?t.touches[0].clientX:t.clientX,n=device?t.touches[0].clientY:t.clientY;drawRound(context,movex,movey,o,n),drawRound(context,movex,movey,o,n),movex=o,movey=n}window.onload=function(){drawMask(context)},cas.addEventListener(Press,down,!1),cas.addEventListener(Move,move,!1),cas.addEventListener(Uplift,function(e){t=0,isMouseDown=!1,50<getTransparencyPercent(context)&&(alert("超过了50%的面积"),clearRect(context))},!1);